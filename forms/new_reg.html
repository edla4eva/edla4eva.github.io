<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Course Registration Form</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script
    src="https://code.jquery.com/jquery-3.6.3.min.js"
    integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../css/reg.css">
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <!--  worked <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script> -->
    <!-- latest -->
    <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.es.min.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- todo re enable caching after deployment of stable version -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <!-- end disable cache -->
</head>
    <body>
        <nav class="navbar navbar-expand-md bg-light navbar-light navbar-sticky-top">
            <div class="d-flex "><a href="#"><img src="" class="img-fluid" alt="UNIBEN"></a></div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="collapsibleNavbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                    <a class="nav-link" href="new_reg.html?session=2022/2023&level=100">New Registration</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="continue_reg.html?session=2022/2023&level=100">Continue Registration</a>
                    </li>
                    <!-- Dropdown -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                            Auto Registration
                        </a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="new_reg.html?session=2022/2023&level=100">Register All 100Level Courses</a>
                            <a class="dropdown-item" href="new_reg.html?session=2022/2023&level=200">Register All 200Level Courses</a>
                            <a class="dropdown-item" href="new_reg.html?session=2022/2023&level=300">Register All 300Level Faculty Courses</a>
                            <a class="dropdown-item" href="new_reg.html?session=2022/2023&level=400">Register All 400Level Faculty Courses</a>
                            <a href="late_reg.html?session=2021/2022">Late Registration for 2021/2022 Session - 100Level</a> 
                            <a href="late_reg.html?session=2021/2022&level=200">Late Registration  for 2021/2022 Session - 200Level</a>
                        </div>
                    </li>
                </ul>
            </div>  

        </nav>
        <div class="container .bg-primary">

            <!-- Add/Remove -->
            <div class="row">

                    <div class="col-md-2">
                    </div>
                    <!-- p-l-5 padding - left - size5 -->
                    <div class="col-md-8 border border-primary  ml-3 mb-3 mr-3">

                        <div id="topButtonsDiv">
                            
                            <h1 class="text-center">University Of Benin, Benin City</h1>
                            <h1 class="text-center">Faculty of Engineering </h1>
                            <h3 class="text-center">Online Examination Course Registration Form</h1>

                        </div>

                        <div id='message_print_all'>
                            <div id="bypassme">
                                <h2 class="text-center">UNIVERSITY OF BENIN, BENIN CITY</h2>
                                <h4 class="text-center">FACULTY OF ENGINEERING</h4>
                                <h5 class="text-center">EXAMINATION COURSE REGISTRATION FORM 2021/2022 SESSION</h5>
                                <br>
                            </div>
                            <div style="float: right;" >
                                <img id ="img-pix" class="rounded mx-auto d-block" width="150" height="150" src="../images/usr.jpg" />
                            </div>
                            <table class="table" border="1">
                            <!-- <tr><td class="mw-40" style="width: 180px;">-</td><td>-</td></tr> -->
                            <tr><td>MAT. NO.</td><td  id="td_matno">matno </td></tr>
                            <tr><td>SURNAME</td><td id="td_surname">student_surname</td></tr>
                            <tr><td>FIRST NAME</td><td id="td_firstname">student_firstname </td></tr>
                            <tr><td>OTHER NAMES</td><td id="td_othernames">student_firstname </td></tr>
                            <tr><td>DEPARTMENT</td><td id="td_department">selDept</td></tr>
                            <tr><td>MODE OF ENTRY</td><td id="td_mode">mode_of_entry </td></tr>
                            <tr><td>LEVEL</td><td id="td_level">level </td></tr>
                            <tr><td>Session</td><td id="td_session">level </td></tr>
                            <tr><td>PHONE NO.</td><td id="td_phone">phone </td></tr>
                            <tr><td>GENDER</td><td id="td_gender">gender </td></tr>
                            </table>
                            <h5 class="text-center">REGISTER CARRY OVER COURSES FIRST</h5>
                            <table class="table" border="1" id="table_courses">
                                <tr><td>FIRST SEMESTER</td><td>SECOND SEMESTER</td></tr>     

                                <tr><td><pre id="td_courses1">course1</pre></td><td><pre id="td_courses2">course2</pre></td></tr>
                                <tr><td id ="td_total1">Total"  -  "glbCredit_1</td><td id ="td_total2">Total"  -  "glbCredit_2</td> </tr>
                            </table>

                            <div id="previewButtons">
                                <button class="btn btn-primary btn-lg btn-block"  type="button" id="btnEdit" onclick="editReg()"> Edit Form </button>
                                <button class="btn btn-primary btn-lg btn-block"  type="button" id="printForm" onClick="doPrintPDF();">Print Form (Download PDF)</button> <br>
                                <button class="btn btn-success btn-lg btn-block" id="btnFinalSubmit" type="button" onclick="finalSubmit()">Submit to Course Adviser (Cannot be Undone)</button>

                            </div>

                        </div>
                        <div id='message_print'>

                        </div>
                        <form id="hiddenForm">
                            <input type="text" id="glbCredits" name="glbCredits" value="0" hidden/>
                            <input type="text" id="glbCredits_1" name="glbCredits_1" value="0" hidden/>
                            <input type="text" id="glbCredits_2" name="glbCredits_2" value="0" hidden/>
                            <input type="text" id="glbCourses" name="glbCourses" value="ECP281;CPE311" hidden/>
                        </form>

                        <form id="regForm" action="" method="post" class="ml-5 mb-3 mr-5 mt-5" enctype="multipart/form-data">
                            <h1>Online Course Registration</h1>
                             <h5>Carefully fill the form below then preview before submission!</h5>
                            <br>
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="name">MAT. NO.</label>
                                    <input type="text" id="matno" name="matno" placeholder="ENG..." required autofocus />

                                </div>
                                <div class="form-group col-md-6">
                                </div>
                            </div>

                            <br>
                            <label for="student_surname"><b>SURNAME* (in capital letters e.g ADAMU)</b></label>
                            <input type="text" placeholder="SURNAME" name="student_surname" id="student_surname" required>
                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="dob"><b>Firstname * (e.g Smith)</b></label>
                                    <input type="text" placeholder="Firstname *" name="student_firstname"  id="student_firstname"  required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="student_othernames"><b>Othernames (e.g Sadiku)</b></label>               
                                    <input type="text" placeholder="Othernames" name="student_othernames" id="student_othernames">                           
                                </div>

                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                  <label for="dept_idr">Dept ID (eg 1 for CPE)</label>
                                  <input type="text" class="form-control" id="student_dept_idr" name="student_dept_idr" value = "1" hidden>
                                  <select id="dept_idr" name="dept_idr" class="form-control">
                                    <option value="1" selected>1. Computer Engineering</option>
                                    <option value="5">5	Agricultural Engineering</option>
                                    <option value="6">6	Chemical Engineering</option>
                                    <option value="18">18 Civil Engineering</option>
                                    <option value="8">8	Electrical/Electronics Engineering</option>
                                    <option value="9">9	Industrial Engineering</option>
                                    <option value="10">10 Marine Engineering</option>
                                    <option value="11">11 Material and Metrolog Engineering</option>
                                    <option value="12">12 Mechanical Engineering</option>
                                    <option value="13">13 Mechatronics Engineering</option>
                                    <option value="14">14 Metallurgical and Material Engineering</option>
                                    <option value="15">15 Petroleum Engineering</option>
                                    <option value="16">16 Production Engineering</option>
                                    <option value="17">17 Structural Engineering</option>
                                    <option value="19">19 Geomatics</option>
                                    <option value="20">20 Vocational and Technical Education</option>
                                    
                                    <option value="2">2. Diploma in Computing and Computer Technology</option>
                                    <option value="3">3	Diploma In  Marine Drilling And Production Technology</option>
                                    <option value="4">4	Diploma In  Maritime Studies, Information & Communication Technology</option>
                                    <option value="0">0	Generic Department</option>

                                  </select>
                                </div>
                                <div class="form-group col-md-3">
                                  <label for="inputState">Session</label>
                                  <select id="session_idr" name="session_idr" class="form-control">
                                    <option value="2020/2021">2020/2021</option>
                                    <option value="2021/2022">2021/2022</option>
                                    <option value="2022/2023" selected>2022/2023</option>
                                    <option value="2023/2024">2023/2024</option>
                                    <option value="2024/2025">2024/2025</option>
                                    <option value="2025/2026">2025/2026</option>
                                    <option value="2026/2027">2026/2027</option>
                                    <option value="2026/2027">2027/2028</option>
                                    <option value="2026/2027">2028/2029</option>
                                  </select>
                                </div>
                                <div class="form-group col-md-3">
                                  <label for="level">Level</label>
                                  <select id="level" name="level" class="form-control">
                                    <option value="100" selected>100</option>
                                    <option value="200" >200</option>
                                    <option value="300" >300</option>
                                    <option value="400" >400</option>
                                    <option value="500" >500</option>
                                      <option value="600" >500</option>
                                      <option value="700" >500</option>
                                      <option value="800" >500</option>
                                  </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-4">
                                  <label for="year_of_entry">Year of Entry (e.g 2019)</label>
                                  <select id="year_of_entry" name="year_of_entry" class="form-control">
                                    <option value = "2012" selected>2012</option>
                                    <option value = "2013">2013</option>
                                    <option value = "2014">2014</option>
                                    <option value = "2015">2015</option>
                                    <option value = "2016">2016</option>
                                    <option value = "2017">2017</option>
                                    <option value = "2018">2018</option>
                                    <option value = "2019">2019</option>
                                    <option value = "2020">2020</option>
                                    <option value = "2021">2021</option>
                                    <option value = "2022">2022</option>
                                    <option value = "2023">2023</option>
                                    <option value = "2024">2024</option>
                                  </select>
                                </div>
                                <div class="form-group col-md-4">
                                  <label for="session_idr_of_entry">Session of Entry</label>
                                  <select id="session_idr_of_entry" name="session_idr_of_entry" class="form-control">
                                    <option value="2012/2013" selected>2012/2013</option>
                                    <option value="2013/2014">2013/2014</option>
                                    <option value="2014/2015">2014/2015</option>
                                    <option value="2015/2016">2015/2016</option>
                                    <option value="2016/2017">2016/2017</option>
                                    <option value="2017/2018">2017/2018</option>
                                    <option value="2018/2019">2018/2019</option>
                                    <option value="2019/2020">2019/2020</option>
                                    <option value="2020/2021">2020/2021</option>
                                    <option value="2021/2022">2021/2022</option>
                                    <option value="2022/2023">2022/2023</option>
                                    <option value="2023/2024">2023/2024</option>
                                    <option value="2024/2025">2024/2025</option>
                                  </select>
                                </div>
                                <div class="form-group col-md-4">
                                  <label for="mode_of_entry">Mode of Entry (UME or DE)</label>
                                  <select id="mode_of_entry" name="mode_of_entry" class="form-control">
                                    <option value="UME" selected>UME</option>
                                    <option value="DE">DE</option>
                                    <option value="TRANSFER">TRANSFER</option>
                                  </select>
                                </div>
                            </div>

                            <div class="form-row">

                                <div class="form-group col-md-6">
                                    <label for="psw"><b>Password</b></label>
                                    <input type="password" placeholder="Enter Password" name="psw" id="psw" required>       
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="psw-repeat"><b>Repeat Password</b></label>
                                    <input type="password" placeholder="Repeat Password" name="psw-repeat" id="psw-repeat" required>
                                </div>

                            </div>                                    


                            <hr>

                             <p>Bio Data</p>
                             <label for="dob"><b>Date of birth *</b></label>
                             <input type="text" placeholder="Date of birth *" name="dob"  id="dob" onfocus="(this.type = 'date')" required>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="email"><b>Email *</b></label>
                                    <input type="text" placeholder="Email *" name="email"  id="email"  required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="phone"><b>Phone</b></label>               
                                    <input type="text" placeholder="Phone" name="phone" id="phone">                           
                                </div>

                            </div>



                            <div class="form-row">
                                <div class="form-group col-md-6">
                                  <label for="gender">Gender</label>
                                  <select id="gender" name="gender" class="form-control">
                                    <option selected>male</option>
                                    <option>female</option>
                                  </select>
                                </div>
                                <div class="form-group col-md-3">
                                  <label for="Fees_Status">Fees</label>
                                  <select id="Fees_Status" name="Fees_Status" class="form-control">
                                    <option selected>paid</option>
                                    <option>unpaid</option>
                                  </select>
                                </div>
                                <div class="form-group col-md-3">
                                  <label for="status">Status</label>
                                  <select id="status" name="status" class="form-control">
                                    <option selected>Successful</option>
                                    <option>Probation</option>
                                    <option>Carry Over</option>
                                    <option>Transfer</option>
                                  </select>
                                </div>
                            </div>

                            <p>Upload recent passport size Photo (Must be on red background; Max size 20kb; tip: use pix in Kofa)</p><input id="file_info"></input>
                            <!-- <button onClick="upload.php">Upload</button> -->
                            <img id="previewPix" class="rounded mx-auto d-block" width="80" height="80" src="" />
                            <input type="file" id="file_pix" name="file_pix" class="form-control"  required>
                            <br><hr>
                            <h3>Add/Remove Courses</h3>
                            <div class="row">
                                <div class="col-md-12">
                                    <input class="btn btn-outline-info btn-lg btn-block" type="button" id="btnGenerate" value="Load Courses" onclick="PopulateDropDownList(900,0)" />
                                    <div class="spinner-border"></div>

                                </div>
                               
                            </div>

                            



                            <div class="row p-l-5">
                                <div class="input_fields_wrap_1 col-md-6">
                                    <h5>First Semester Courses</h5>
                                    <input type="text" name="CourseCode_1" id="CourseCode_1" class="CourseCode_1" readonly />

                                    <!-- class="js-example-basic-single w-75 p-1"  -->
                                    <div class="input-group mb-3"><select class="js-example-basic-single w-75 p-1"  id="comboCourses_1"></select><div class="input-group-append"><button class="btn btn-outline-success add_field_button_1" type="button">Add</button></div></div>
                                </div>
                                <div class="input_fields_wrap_2 col-md-6">
                                    <h5>Second Semester Courses</h5>
                                    <input type="text"  class="CourseCode_2" id="CourseCode_2" name="CourseCode_2" value="" readonly />

                                    <div class="input-group mb-3"><select class="w-75 p-1"  id="comboCourses_2"></select><div class="input-group-append_2"><button class="btn btn-outline-success add_field_button_2" type="button">Add</button></div></div>
                                </div>
                                
                                <hr />
                                <br>
                                <!-- <p>TODO: NA Courses</p> -->
                            </div>
                             
                            <p>Cross check the entries you made on the form before you submit</p>
                            <div id="buttonsDiv">
                         
                        

                                
                                <br>

    
                                
                                <p class = "text text-info">Before you submit you must agree to the terms and conditions</p><a href="regulations.pdf"  target="_blank">Download PDF (Opens in new window)</a>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="chkTAR" >
                                    <label class="form-check-label" for="chkTAR">
                                    I have downloaded and read the terms and condition
                                    </label>
                                </div>
                                <button type="submit"  class="btn btn-success btn-lg btn-block" id=" btnPreview" type="button">
                                    Preview before Submitting
                                </button>
                            </div>

                        </form>


                    </div>
                    <div class="col-md-2">
                        <!-- Right side -->
                    </div>

            </div>
        </div>
        <hr>
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Worked -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script>
        <!-- causes error -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> -->
        <script src="js/reg_functions.js"></script>
        <!-- JavaScript add new form and respond to select(combo) changes-->
        <script>
            $(document).ready(function() {
                //new way
                var formController = {
                    urlLocal : 'http://localhost/rtps/web/back-end/public/index.php/api/',
                    urlCloud : 'https://www.rtps.keminsoft.site/public/index.php/api/',
                    maxFields: 18,
                    x_1: 1,
                    x_2: 1,
                    
                    // Fields wrapper elements
                    wrapper1: $(".input_fields_wrap_1"),
                    wrapper2: $(".input_fields_wrap_2"),
                    
                    // Add button elements
                    addButton1: $(".add_field_button_1"),
                    addButton2: $(".add_field_button_2"),

                    initializeFormViewObj: function() {
                        // Your initialization code here
                        x_1 = 1;
                    },
                    
                    // Other methods and properties can be defined here
                };

                // Initialize the form view
                formController.initializeFormViewObj();
                console.log(formController.urlCloud);
                //config
                urlLocal = 'http://localhost/rtps/web/back-end/public/index.php/api/';
                urlCloud = 'https://www.rtps.keminsoft.site/public/index.php/api/';
                url_global = urlLocal;
                glb_Courses ="";
                glbCredit = 0;
                glbCredit_1 = 0;
                glbCredit_2 = 0;

                var max_fields      = 18; //maximum input boxes allowed
                var wrapper_1   		= $(".input_fields_wrap_1"); //Fields wrapper
                var wrapper_2   		= $(".input_fields_wrap_2"); //Fields wrapper
                var add_button_1      = $(".add_field_button_1"); //Add button ID
                var add_button_2      = $(".add_field_button_2"); //Add button ID
                // var update_button      = $(".update_field_button"); //Update button ID
                var x_1 = 1; //initlal text box count
                var x_2 = 1; //initlal text box count
                
                //setup view
                //initializeFormView();

                //get courses from local json
                // Using fetch to load data from a local .json file
                fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    console.log(data); // Output the loaded data
                    generateCourseInputs(data);
                })
                .catch(error => {
                    console.error('Error:', error);
                });

                

                  // Submit button
                  $("#submitbtn").click(function () {
                    validateUsername();
                    validateMatNo();
                    //validateConfirmPassword();
                    //validateEmail();
                    if (
                      usernameError == true &&
                      matnoError == true
                    ) {
                      return true;
                    } else {
                      return false;
                    }
                  });
            });
            
            //last
            $(document).ready(function() {
                // Get the 'session' parameter from the URL
                var sessionParameter = getUrlParameter('session');

                // Fill the input element with the session parameter value
                $('#session_idr').val(sessionParameter);
            });
    
            function finalSubmit(){
                //console.log(document.body);
                $(btnEdit).hide();
                $(btnFinalSubmit).hide();
                $(printForm).show(); //this line causes error DOM?
                //todo set submit at backend

                let formData = new FormData();
                var MatNo = $("#matno").val();
                $.ajax({
                        type: "POST",
                        url: url_global + "final_submit_reg/" + MatNo,
                        data: formData,
                        encode: true,
                        success: function (data) {

                        }
                    });
            }

        </script>

    </body>
</html>
