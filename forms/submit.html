
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
    <script
    src="https://code.jquery.com/jquery-3.6.0.js"
    integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous">
    </script>
    <link rel="stylesheet" href="../css/reg.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
    <body>

        <div class="container .bg-primary">

            <!-- Add/Remove -->
            <div class="row">
                    <div class="col-md-2">
                    </div>
                    <!-- p-l-5 padding - left - size5 -->
                    <div class="col-md-8 border border-primary  ml-3 mb-3 mr-3">
                        <form id="reg-form" action="" method="post" class="ml-5 mb-3 mr-5 mt-5" enctype="multipart/form-data">
                            <h1>Course Registration</h1>
                             <h3>Fill the form below and press the submit button!</h3>
                            <p>Upload recent passport size Photo (Must be on red background; Max size 12kb)</p><input id="file_info"></input>
                            <input type="file" id="file" name="file" required>
                            <br><hr>
                            <button type ="submit">Upload</button>
                        </form>
                    </div>
                    <div class="col-md-2">

                    </div>

            </div>
        </div>
        <hr>
        

        <script>     
            //ajax for posting form data
            $(document).ready(function () {
             
               //ajax for posting form data
                urlLocal = 'http://localhost/rtps/web/back-end/public/index.php/api/';
                urlCloud = 'https://www.rtps.keminsoft.site/public/index.php/api/';
                url_global = urlLocal;

                $("#file").on("change", function (e) {

                    uploadPix(this);
                    alert("Changed");
                    var count=1;
                    var files = e.currentTarget.files; // puts all files into an array
                    var approvedHTML="";
                    // call them as such; files[0].size will get you the file size of the 0th file
                    for (var x in files) {
                        var filesize = ((files[x].size/1024)/1024).toFixed(4); // MB
                        if (files[x].name != "item" && typeof files[x].name != "undefined" && filesize <= 10) { 
                            if (count > 1) {
                                approvedHTML += ", "+files[x].name;
                            }
                            else {
                                approvedHTML += files[x].name;
                            }
                            count++;
                        }
                    }
                    $("#file_info").val(approvedHTML);
                    console.log(approvedHTML);
                });
            });

            function uploadPix(frm) {
                    alert("Submit");
                    //e.preventDefault();
                    //test image
                    var form = $( this );
                    var MatNo = $("#matno").val();
                    var storeImg = url_global + 'upload';
                    var getImg = url_global + 'jpg/img.png';
                    $.ajax({
                        type: "POST",
                        url: storeImg,
                        data: new FormData(frm),
                        encode: true,
                        success: function (data) {
                            console.log(data);
                            //fetch data to verify if post was successful
                            text = '<img width="150" height="150" src="'+ url_global + 'jpg/' + picMatno + '.png" />';
                            $("#regForm").append(text)
                        },
                        error: function (data) {
                            console.log(data);
                            alert("An error occured posting data \n" + data.responseJSON.message);
                        }
                    });

                };

        </script>

 


    </body>
</html>
